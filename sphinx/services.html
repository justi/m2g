

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Services &mdash; m2g v1.1.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/ocp_favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="m2g v1.1.1 documentation" href="../index.html"/>
        <link rel="next" title="OCP" href="ocp.html"/>
        <link rel="prev" title="Single Node Configuration" href="local_config.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> m2g
        

        
          
          <img src="../_static/ocp_main.png" class="logo" />
        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="local_config.html">Single Node Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="local_config.html#basic-package-update-and-install">Basic Package Update and Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_config.html#install-and-configure-python-2-7">Install and Configure Python 2.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_config.html#basics-for-development">Basics for Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_config.html#oracle-java-install">Oracle Java Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_config.html#java-setup">Java Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_config.html#camino-and-fsl">Camino and FSL</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_config.html#igraph">igraph</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_config.html#m2g-setup">m2g setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_config.html#export-paths-and-setup-environment">Export Paths and Setup Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_config.html#running-test-workflow">Running test workflow</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-m2g-on-captive-cluster">Using m2g on captive cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-m2g-in-an-ami">Using m2g in an AMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#downloading-graphs">Downloading Graphs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ocp.html">OCP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ocp.html#contributing">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="ocp.html#style-guides">Style Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="ocp.html#ocp-support-forums">OCP Support Forums</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/data.html">Data Formats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/data.html#input-data">Input Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/data.html#output-data">Output Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/available_data.html">Public Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/basic_usage.html">Basic Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/basic_usage.html#m2g-complete-pipeline">m2g Complete Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/basic_usage.html#m2g-registration-pipeline">m2g Registration Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/basic_usage.html#m2g-diffusion-processing-pipeline">m2g Diffusion Processing Pipeline</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/advanced_usage.html">Advanced Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/advanced_usage.html#dti-preprocessing">DTI Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/advanced_usage.html#registration">Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/advanced_usage.html#diffusion-processing">Diffusion Processing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/validation.html">Validation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/validation.html#computing-reliability-on-your-data">Computing Reliability on your Data</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Further Reading</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/functions.html">Function Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/bet.html">FSL Brain Extraction Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/flirt.html">FSL Linear Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/parse_b.html">Parse B-values/vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extract_b0.html">Extract B0 Volume</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/eddycorrect.html">FSL Eddy Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/tensor_gen.html">DTI Tensor Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/fiber_gen.html">Fiber Tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/fiber_convert.html">Fiber Converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gengraph.html">Graph Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/gengraph.html#intuition-behind-graph-generation">Intuition Behind Graph Generation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/downsample_atlas.html">Downsample Atlas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/downsample.html">Downsample Graph</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference external" href="http://ocp.me/graph-services/c4/">Web service</a></li>
<li class="toctree-l1"><a class="reference external" href="https://gitter.im/openconnectome/m2g">Gitter chatroom</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/a/ocp.me/forum/#!forum/m2g">Mailing List</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/openconnectome/m2g">Github repo</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/openconnectome/m2g/releases/">Release Notes</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">m2g</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Services</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/sphinx/services.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="services">
<h1>Services<a class="headerlink" href="#services" title="Permalink to this headline">¶</a></h1>
<div class="section" id="using-m2g-on-captive-cluster">
<h2>Using m2g on captive cluster<a class="headerlink" href="#using-m2g-on-captive-cluster" title="Permalink to this headline">¶</a></h2>
<p>In order to run m2g on the captive cluster we run in house (braincloud1), we expect you to have the following requirements satisfied:</p>
<ol class="arabic simple">
<li>A LONI client installed on your computer that is the same version as our sever (Currently v6.0.1). If you cannot find this version on <a class="reference external" href="http://www.loni.usc.edu/Software/Pipeline">their website</a>, contact them and <a class="reference external" href="http://pipeline.loni.usc.edu/learn/contact/">request a copy</a>.</li>
<li>Your data organized in compliance with our <a class="reference external" href="http://m2g.io/tutorials/input_data.html">input specification</a></li>
<li>An account on the cluster. If you don&#8217;t have an account and would like one, you can email <a class="reference external" href="mailto:support&#37;&#52;&#48;neurodata&#46;io">support<span>&#64;</span>neurodata<span>&#46;</span>io</a> to see if you&#8217;re eligible.</li>
</ol>
<p><strong>Moving your data:</strong></p>
<ul class="simple">
<li>scp/rsync or equivalently move your data to braincloud1:/brainstore/MR/</li>
<li>ensure that the data directory is readable and writeable by user pipeline. An example of this is done below</li>
</ul>
<div class="highlight-none"><div class="highlight"><pre>rsync -rv --progress /path/to/mydata ${user}@braincloud1.cs.jhu.edu:/brainstore/MR/mydata
ssh ${user}@braincloud1.cs.jhu.edu
cd /brainstore/MR/mydata
chmod -R 775 ./
</pre></div>
</div>
<p><strong>Processing your data:</strong></p>
<ul class="simple">
<li>On your computer, open the LONI client and connect to braincloud1</li>
<li>Open the m2g workflow found in your local cloned copy of the m2g repo at subdirectory <cite>library/workflows/m2g_lists.pipe</cite></li>
<li>Open the variables dialog from the wrench on the top right. The <cite>inputDir</cite> variable should be set to the location of your data. The <cite>outputBaseDir</cite> should be the location you would like derivates to be stored. The <cite>sglabels</cite> variable points to a file which contains a list of parcelations to process your data with. You can open this file on braincloud to see the atlases chosen, and if you wish to adjust the atlases used you can create a new file in your data directory containing paths to the atlases you wish to use (if they don&#8217;t exist in m2g already, you will need to copy them as well like was done above). If you wish to process in a space other than the MNI152 template, then you will also need to provide new paths for the remaining variables to the atlas space you wish to use.</li>
<li>Press run</li>
<li>Find your <a class="reference external" href="http://m2g.io/tutorials/input_data.html#output-data">graphs and other derivatives</a> from the base directory you provided</li>
<li>Enjoy!</li>
</ul>
</div>
<div class="section" id="using-m2g-in-an-ami">
<h2>Using m2g in an AMI<a class="headerlink" href="#using-m2g-in-an-ami" title="Permalink to this headline">¶</a></h2>
<p>Before beginning this guide, please ensure that you have the following:
1. Amazon AWS credentials
2. Your data organized in compliance with our <a class="reference external" href="http://m2g.io/tutorials/input_data.html">input specification</a></p>
<p><strong>Creating and connecting to the workstation:</strong></p>
<ul class="simple">
<li>Log in to the AWS Console and navigate to EC2 services</li>
<li>Create new EC2 instance</li>
<li>Under &#8216;Community AMIs&#8217; search for &#8216;neurodata&#8217; and select the most recent version</li>
<li>Proceed to select computer size, storage, and security preferences, and launch instance</li>
<li>Once your instance is online, initiate an SSH tunnel through a terminal on your computer by running the following command with your ip address. You will be prompted to enter the password <cite>neurodata</cite>:</li>
</ul>
<div class="highlight-none"><div class="highlight"><pre>ssh -L 5901:127.0.0.1:5901 -N -f -l neurodata ${ip}
</pre></div>
</div>
<ul class="simple">
<li>Open a VNC client like RealVNC <a class="reference external" href="https://www.realvnc.com/products/chrome/">https://www.realvnc.com/products/chrome/</a></li>
<li>Connect to 127.0.0.1:5901 and enter the password <cite>neurodata</cite></li>
<li>Login to the workstation using the same password</li>
</ul>
<p><strong>Processing your data:</strong></p>
<ul class="simple">
<li>Mount an addtional harddrive with sufficient storage capacity for your data</li>
<li>Move all of your data into your new harddrive (either through s3, or scp or equivalent)</li>
<li>Create a <cite>temp</cite> directory on this new harddrive, as well</li>
<li>Open terminal and type the following:</li>
</ul>
<div class="highlight-none"><div class="highlight"><pre>cd /share0/m2g/
git pull
cd /share0/src/loni/loni_6.0.1
./PipelineGui.sh
</pre></div>
</div>
<ul class="simple">
<li>A LONI Pipeline window will open. Decline any prompts to update this client upon load</li>
<li>Open the m2g workflow, located at <cite>/share0/m2g/library/m2g_sources_bc1_v4.pipe</cite></li>
<li>In LONI, open the <cite>Edit &gt; Preferences</cite> menu</li>
<li>Change the Pipeline Cache to the <cite>temp</cite> folder you created earlier. Be sure that directory has permissions <cite>777</cite></li>
<li>Change the number of simultaneous jobs in Local Execution to be approximately 90-95% of the total cores in your instance</li>
<li>Open the variables dialog from the wrench on the top right, and change the variables to point to your data and where you want your derivatives stored</li>
<li>Press run</li>
<li>Find your graphs and other derivatives from the base directory you provided</li>
<li>Enjoy!</li>
</ul>
</div>
<div class="section" id="downloading-graphs">
<h2>Downloading Graphs<a class="headerlink" href="#downloading-graphs" title="Permalink to this headline">¶</a></h2>
<p>Our graph service engine, <a class="reference external" href="http://mrbrain.cs.jhu.edu/graph-services/welcome/">MROCP</a>, hosts graph data of a variety of species and scales, as well as enables downsampling and type conversion of graphs.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ocp.html" class="btn btn-neutral float-right" title="OCP" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="local_config.html" class="btn btn-neutral" title="Single Node Configuration" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Open Connectome Project.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v1.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>